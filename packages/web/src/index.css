*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

:root {
  --bg: #0d1117;
  --bg-secondary: #161b22;
  --bg-tertiary: #21262d;
  --border: #30363d;
  --text: #c9d1d9;
  --text-muted: #8b949e;
  --accent: #58a6ff;
  --green: #3fb950;
  --red: #f85149;
}

html, body, #root {
  height: 100%;
  background: var(--bg);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
  font-size: 14px;
}

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg);
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 4px;
}

@keyframes pulse-waiting {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.3; }
}

.waiting-indicator {
  animation: pulse-waiting 1.5s ease-in-out infinite;
}

@keyframes pulse-active {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(0.7); }
}

.active-indicator {
  animation: pulse-active 0.8s ease-in-out infinite;
}

/* Shortcut number badges */
.shortcut-badge {
  font-family: monospace;
  font-size: 9px;
  font-weight: 600;
  line-height: 1;
  min-width: 14px;
  height: 14px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 3px;
  flex-shrink: 0;
  user-select: none;
}
.shortcut-badge-machine {
  background: var(--bg-tertiary);
  color: var(--text-muted);
  border: 1px solid var(--border);
}
.shortcut-badge-session {
  background: transparent;
  color: var(--text-muted);
  opacity: 0.6;
}

/* Drag-to-reorder handles */
.drag-handle {
  opacity: 0;
  color: var(--text-muted);
  transition: opacity 0.15s;
  cursor: grab;
}
.sidebar-machine-row:hover .drag-handle,
.sidebar-session-row:hover .drag-handle {
  opacity: 0.5;
}
.drag-handle:hover {
  opacity: 1 !important;
}
[draggable="true"] {
  cursor: default;
}
[draggable="true"]:active {
  cursor: grabbing;
}

/* Live mode: animated rainbow border around textarea */
@property --live-angle {
  syntax: "<angle>";
  initial-value: 0deg;
  inherits: false;
}
@keyframes live-rotate {
  to { --live-angle: 360deg; }
}
.live-border-wrap {
  position: relative;
  border-radius: 6px;
  padding: 2px;
  flex: 1;
  background: conic-gradient(
    from var(--live-angle),
    #f85149, #ff6a33, #f0c040, #3fb950, #58a6ff, #bc8cff, #f778ba, #f85149
  );
  animation: live-rotate 2.5s linear infinite;
}
.live-border-wrap > textarea {
  position: relative;
  z-index: 1;
  display: block;
}

/* LIVE toggle: mobile full-width version (hidden on desktop) */
.live-toggle-mobile {
  position: relative;
  width: 100%;
  padding: 10px 16px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg-tertiary);
  color: var(--text-muted);
  cursor: pointer;
  font-family: inherit;
  display: none; /* shown via media query */
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: all 0.3s;
  overflow: hidden;
  min-height: 44px;
}
/* LIVE toggle: desktop compact version */
.live-toggle-desktop {
  transition: all 0.3s;
}
.live-toggle-desktop.live-toggle-on {
  background: linear-gradient(270deg, #f85149, #58a6ff, #3fb950, #f85149) !important;
  background-size: 300% 100% !important;
  animation: live-bg-shift 3s ease infinite !important;
  border-color: transparent !important;
  color: #fff !important;
}
.live-toggle-label {
  font-size: 13px;
  font-weight: 700;
  letter-spacing: 2px;
}
.live-toggle-hint {
  font-size: 11px;
  font-weight: 400;
  opacity: 0.6;
}

/* Active state: rainbow explosion */
@keyframes live-bg-shift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}
@keyframes live-btn-glow {
  0%, 100% { box-shadow: 0 0 8px rgba(248,81,73,0.4), 0 0 20px rgba(88,166,255,0.2); }
  25% { box-shadow: 0 0 8px rgba(63,185,80,0.4), 0 0 20px rgba(240,192,64,0.2); }
  50% { box-shadow: 0 0 8px rgba(88,166,255,0.4), 0 0 20px rgba(188,140,255,0.2); }
  75% { box-shadow: 0 0 8px rgba(247,120,186,0.4), 0 0 20px rgba(248,81,73,0.2); }
}
.live-toggle-on {
  background: linear-gradient(
    270deg,
    #f85149, #ff6a33, #f0c040, #3fb950, #58a6ff, #bc8cff, #f778ba, #f85149
  );
  background-size: 400% 100%;
  animation: live-bg-shift 4s ease infinite, live-btn-glow 3s ease-in-out infinite;
  border-color: transparent;
  color: #fff;
}
.live-toggle-on .live-toggle-label {
  text-shadow: 0 1px 4px rgba(0,0,0,0.4);
}
.live-toggle-on .live-toggle-hint {
  opacity: 0.85;
  text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}

/* Desktop defaults (overridden by mobile media query below) */
.sidebar-backdrop {
  display: none;
}
.mobile-topbar {
  display: none;
}

/* ── Mobile responsive (≤768px) ── */
@media (max-width: 768px) {
  /* Sidebar as slide-out drawer */
  .sidebar {
    position: fixed !important;
    top: 0;
    left: 0;
    bottom: 0;
    z-index: 100;
    transform: translateX(-100%);
    transition: transform 0.25s ease;
    width: 280px !important;
  }
  .sidebar.open {
    transform: translateX(0);
  }

  /* Backdrop behind drawer */
  .sidebar-backdrop {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 99;
  }

  /* Mobile top bar */
  .mobile-topbar {
    display: flex !important;
  }

  /* Hide desktop resize handle */
  .sidebar-resize-handle {
    display: none !important;
  }

  /* Full-screen panel overlay */
  .panel-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100% !important;
    z-index: 50 !important;
  }

  /* Panel tab bar: hide desktop tab strip */
  .panel-tabs-desktop {
    display: none !important;
  }

  /* Touch-friendly chat buttons */
  .chat-buttons button {
    min-height: 44px;
    min-width: 44px;
    padding: 8px 14px !important;
    font-size: 14px !important;
  }

  /* Show full-width LIVE toggle on mobile, hide desktop version */
  .live-toggle-mobile {
    display: flex !important;
  }
  .live-toggle-desktop {
    display: none !important;
  }
}
